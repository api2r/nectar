<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Use a provided function — do_if_fn_defined • nectar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use a provided function — do_if_fn_defined"><meta name="description" content="When constructing API calls programmatically, you may encounter situations
where an upstream task should indicate which function to apply. For example,
one endpoint might use a special auth function that isn't used by other
endpoints. This function exists to make coding such situations easier."><meta property="og:description" content="When constructing API calls programmatically, you may encounter situations
where an upstream task should indicate which function to apply. For example,
one endpoint might use a special auth function that isn't used by other
endpoints. This function exists to make coding such situations easier."><meta property="og:image" content="https://nectar.api2r.org/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nectar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jonthegeek/nectar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Use a provided function</h1>
      <small class="dont-index">Source: <a href="https://github.com/jonthegeek/nectar/blob/main/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>do_if_fn_defined.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When constructing API calls programmatically, you may encounter situations
where an upstream task should indicate which function to apply. For example,
one endpoint might use a special auth function that isn't used by other
endpoints. This function exists to make coding such situations easier.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_if_fn_defined</span><span class="op">(</span><span class="va">x</span>, fn <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, call <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/stack.html" class="external-link">caller_env</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object to potentially modify, such as a <code><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">httr2::request()</a></code>
object.</p></dd>


<dt id="arg-fn">fn<a class="anchor" aria-label="anchor" href="#arg-fn"></a></dt>
<dd><p>A function to apply to <code>x</code>. If <code>fn</code> is <code>NULL</code>, <code>x</code> is returned
unchanged.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to pass to <code>fn</code>.</p></dd>


<dt id="arg-call">call<a class="anchor" aria-label="anchor" href="#arg-call"></a></dt>
<dd><p>(<code>environment</code>) The environment from which a function was called,
e.g. <code><a href="https://rlang.r-lib.org/reference/stack.html" class="external-link">rlang::caller_env()</a></code> (the default). The environment will be mentioned
in error messages as the source of the error. This argument is particularly
useful for functions that are intended to be called as utilities inside
other functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The object, potentially modified.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">build_api_req</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">endpoint</span>, <span class="va">auth_fn</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/request.html" class="external-link">request</a></span><span class="op">(</span><span class="st">"https://example.com"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">httr2</span><span class="fu">::</span><span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html" class="external-link">req_url_path_append</a></span><span class="op">(</span><span class="va">req</span>, <span class="va">endpoint</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">do_if_fn_defined</span><span class="op">(</span><span class="va">req</span>, <span class="va">auth_fn</span>, <span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most endpoints of this API do not require authentication.</span></span></span>
<span class="r-in"><span><span class="va">unsecure_req</span> <span class="op">&lt;-</span> <span class="fu">build_api_req</span><span class="op">(</span><span class="st">"unsecure_endpoint"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unsecure_req</span><span class="op">$</span><span class="va">headers</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But one endpoint requires authentication.</span></span></span>
<span class="r-in"><span><span class="va">secure_req</span> <span class="op">&lt;-</span> <span class="fu">build_api_req</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"secure_endpoint"</span>, <span class="fu">httr2</span><span class="fu">::</span><span class="va"><a href="https://httr2.r-lib.org/reference/req_auth_bearer_token.html" class="external-link">req_auth_bearer_token</a></span>, <span class="st">"secret-token"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">secure_req</span><span class="op">$</span><span class="va">headers</span><span class="op">$</span><span class="va">Authorization</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Bearer secret-token"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jon Harmon, R Consortium.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

